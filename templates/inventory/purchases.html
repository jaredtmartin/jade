<!--# Jade Inventory Control System-->
<!--#Copyright (C) 2010  Jared T. Martin-->

<!--#    This program is free software: you can redistribute it and/or modify-->
<!--#    it under the terms of the GNU General Public License as published by-->
<!--#    the Free Software Foundation, either version 3 of the License, or-->
<!--#    (at your option) any later version.-->

<!--#    This program is distributed in the hope that it will be useful,-->
<!--#    but WITHOUT ANY WARRANTY; without even the implied account of-->
<!--#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the-->
<!--#    GNU General Public License for more details.-->

<!--#    You should have received a copy of the GNU General Public License-->
<!--#    along with this program.  If not, see <http://www.gnu.org/licenses/>.-->
{% extends "inventory/transactions.html" %}
{% load i18n %}
{% block heading %}{% trans 'Purchases' %} {% endblock%}
{% block moreactions %}
    {% if perms.inventory.add_purchase %}<div class="actiontab" ><a onclick="$('#purchase-form').dialog('open');return false;" href="#" class="action">{% trans 'New' %}</a></div>{% endif %}
    {% if q %}<div class="actiontab" ><a href="/inventory/labels/{{q}}.pdf" class="action">{% trans 'Labels' %}</a></div>{% endif %}
    {% if perms.inventory.view_sale %}<div class="actiontab" ><a href="/inventory/sales/?{% if q %}q={{q}}&{% endif %}{% if start %}start={{start}}&{% endif %}{% if end %}end={{end}}{% endif %}" class="action">{% trans 'Sales' %}</a></div>{% endif %}
    {% if perms.inventory.view_count %}<div class="actiontab" ><a href="/inventory/counts/?{% if q %}q={{q}}&{% endif %}{% if start %}start={{start}}&{% endif %}{% if end %}end={{end}}{% endif %}" class="action">{% trans 'Counts' %}</a></div>{% endif %}
    {% if perms.inventory.view_transfer %}<div class="actiontab" ><a href="/inventory/transfers/?{% if q %}q={{q}}&{% endif %}{% if start %}start={{start}}&{% endif %}{% if end %}end={{end}}{% endif %}" class="action">{% trans 'Transfers' %}</a></div>{% endif %}
    {% if perms.inventory.view_equity %}<div class="actiontab" ><a href="/inventory/equity_list/?{% if q %}q={{q}}&{% endif %}{% if start %}start={{start}}&{% endif %}{% if end %}end={{end}}{% endif %}" class="action">{% trans 'Equity' %}</a></div>{% endif %}
        <div id="purchase-form" title="{% trans 'Create purchase' %}">
	    <form>
		    {% trans 'Doc Number' %}: <input id="doc_number" value="{{q}}" type="text"> <a href="#" onclick="$(this).prev().val('');return false;"><img id="next_doc_number" src="{{MEDIA_URL}}/img/clear.png"/></a><br>
		    {% trans 'Vendor' %}: <input id="vendor" value="{{page.object_list.1.vendor}}" type="text"><br>
		    {% trans 'Item' %}: <input id="item" value="{{page.object_list.1.item}}" type="text"><a href="#" onclick="$(this).prev().val('');$(this).prev().select();return false;"><img id="clear_product" src="{{MEDIA_URL}}/img/clear.png"/></a><br>
	    </form>
    </div>
    <script>
        $(document).ready(function(){
            $("#purchase-form").dialog({
			    autoOpen: false,
			    height: 250,
			    width: 250,
			    position:['right','bottom'],
			    modal: false,
			    buttons: {
				    Close: function() {
					    $(this).dialog('close');
				    },
			        'Create': function() {
			            newTransaction('/inventory/purchase/new/');
			        }
			    },
		    });
            $('#purchase-form #vendor').autocomplete('/inventory/vendor_list/', {matchSubset:0, autoFill:1,});
            $('#purchase-form #item').autocomplete('/inventory/item_list/', {matchSubset:0, autoFill:1,});
            $('#purchase-form #item').keydown(function(e){
                if (e.keyCode == 13) {
                    newTransaction('/inventory/purchase/new/');
                    e.preventDefault();
                    return false;
                }
            });
        });
    </script>
{% endblock%}
